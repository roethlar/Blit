**2025-10-25 03:15:00Z** - **ACTION**: Added Linux metadata snapshot backend for the change journal. `LinuxSnapshot` records device/inode/ctime (+mtime) and enables the planner to skip no-op runs on ext-based filesystems. Added `scripts/linux/run-journal-fastpath.sh` and captured validation run (`logs/linux/journal-fastpath-20251025T031500Z.log`, zero-change mirror in ~3 ms). **Tests**: `cargo fmt`; `cargo check -p blit-core --target x86_64-unknown-linux-gnu`; `bash scripts/linux/run-journal-fastpath.sh`.

**2025-10-25 02:20:00Z** - **ACTION**: Implemented macOS FSEvents snapshot backend for the change journal. `MacSnapshot` now records device FSID, current FSEvents ID, and root mtime; orchestrator refreshes checkpoints so zero-change runs can skip planning on macOS once verified. Added `scripts/macos/run-journal-fastpath.sh` for validation and updated TODO/workflows. **Tests**: `cargo fmt`; `cargo check -p blit-core --target x86_64-unknown-linux-gnu`.

**2025-10-25 02:16:11Z** - **ACTION**: Finalised the Windows USN fast-path integration. Relaxed snapshot comparison to trust matching volume/journal/USN, added checkpoint re-probe before persisting, and confirmed zero-change NTFS mirrors skip planning (28 ms second run via `scripts/windows/run-journal-fastpath.ps1`). Updated TODO/workflows accordingly. **Tests**: `cargo fmt`; `cargo check -p blit-core --target x86_64-unknown-linux-gnu`; `pwsh scripts/windows/run-journal-fastpath.ps1 -Volume NTFS`.

**2025-10-24 03:05:00Z** - **ACTION**: Added filesystem journal fast-path for local mirrors on Windows (USN checkpoints) with persistent cache + CLI integration. The orchestrator now short-circuits planning when the USN journal reports no changes, updating the cache after each run; macOS FSEvents and Linux fanotify remain TODO. Introduced `change_journal.rs` with serde-backed storage and unit tests. **Tests**: `cargo check -p blit-core`; `cargo test -p blit-core change_journal`.

**2025-10-24 01:20:00Z** - **ACTION**: Landed Phase 3 admin RPCs and utilities. Daemon now serves `Find`, `DiskUsage`, `FilesystemStats`, and an expanded `CompletePath` RPC; `blit-utils find/du/df/completions` stream results (with `--json`/filters) off those endpoints. Proto regenerated, CLI/plan/TODO docs updated. **Tests**: `cargo check`; `cargo test -p blit-daemon`; `cargo test -p blit-cli`; `cargo test -p blit-utils`.

**2025-10-23 23:45:00Z** - **ACTION**: Wired up mDNS advertising + discovery. `blit-daemon` now advertises `_blit._tcp.local.` unless `--no-mdns`, and both `blit scan` and `blit-utils scan` list discovered daemons (shared helper in `blit_core::mdns`). Docs/manpages updated accordingly. **Tests**: `cargo check`; `cargo test -p blit-daemon`; `cargo test -p blit-cli`; `cargo test -p blit-utils`.

**2025-10-23 23:05:00Z** - **ACTION**: Remote mirror pushes now purge stale remote files by reusing the daemon's Purge helper; `PushSummary` reports `entries_deleted` and the CLI surfaces the deletion count. Added server-side purge helpers, mirrored fallback handling, and coverage for extraneous deletions. **Tests**: `cargo build -p blit-core`; `cargo check`; `cargo test -p blit-daemon`; `cargo test -p blit-cli`; `cargo test -p blit-utils`.

**2025-10-23 22:05:00Z** - **ACTION**: Implemented daemon Purge RPC and `blit-utils rm` (interactive confirmation plus `--yes` bypass). Added purge unit tests, refreshed Phase 3 workflow notes, and updated TODOs. **Tests**: `cargo check`; `cargo test -p blit-daemon`; `cargo test -p blit-utils`.

**2025-10-21 01:45:00Z** - **ACTION**: Reworked small-file heuristics. `TransferFacade` now samples workloads and flushes tar shards once batches hit ~8 MiB or ≈1 k entries (auto-detecting ≤64 KiB averages), with leftover bundles forced through tar in small-file mode. `transfer_plan::build_plan` mirrors the new thresholds, and regression tests cover both the shard path and the raw-bundle fallback. `cargo test -p blit-core transfer_facade` passes.
**2025-10-20 22:30:00Z** - **RESULT**: Phase 2.5 benchmarks refreshed with isolated target dirs. Linux (`logs/linux/bench_local_size{000,512,2048}_20251020T22****Z/`) shows blit ahead of rsync on 512 MiB (3.85 s vs 6.61 s) and 2 GiB (9.37 s vs 10.19 s); macOS (`logs/macos/bench-local-mirror-size{0,512,2048}-20251020T22****Z/`) has blit ≈3.1× faster than rsync for 512 MiB/2 GiB while rsync still wins the tiny-tree case; Windows (`logs/wingpt/bench-{0mb,512mb,2048mb}-20251020.log`) confirms blit outperforming robocopy by ~7 % (512 MiB) and ~2 % (2 GiB). Phase 2.5 gate criteria satisfied.
**2025-10-20 22:55:00Z** - **ACTION**: Implemented daemon config loader + CLI overrides. `blit-daemon` now reads `/etc/blit/config.toml` (or `--config`), merges module definitions and default root, respects `--bind`, `--port`, `--root`, `--no-mdns`, `--mdns-name`, and warns when falling back to the working directory. Tests updated to use the new constructor. `cargo test --all-targets` remains green.
**2025-10-21 00:45:00Z** - **RESULT**: Captured remaining Phase 2.5 workloads on Linux using the enhanced bench harness (datasets staged under `/tmp` via `SOURCE_DIR`/`DEST_DIR`). 100 k × 4 KiB small-file run (`logs/linux/bench_smallfiles_20251021T001245Z/bench.log`) shows blit 14.29 s vs rsync 9.97 s (70 % of comparator). Mixed workload (512 MiB payload + 50 k × 2 KiB files, `logs/linux/bench_mixed_20251021T002511Z/bench.log`) yields blit 7.66 s vs rsync 6.77 s (88 %). Incremental scenario (`logs/linux/bench_incremental_base_20251021T003800Z/bench.log`, `..._update_20251021T003950Z/bench.log`) has blit 1.98 s vs rsync 1.17 s on the mutation pass. Phase 2.5 remains NO-GO until small/mixed/incremental gaps are solved.
**2025-10-21 01:10:00Z** - **ACTION**: Updated benchmark harnesses to use fair comparator settings. Linux script now defaults to `rsync -a --delete --whole-file --inplace --no-compress --human-readable --stats (--timeout configurable)` and logs the exact args; Windows PowerShell wrapper honours `ROBOCOPY_FLAGS` with `/MIR /COPYALL /FFT /R:1 /W:1 /NDL /NFL /NJH /NJS /NP` by default. All artefacts generated under `/tmp` via `SOURCE_DIR`/`DEST_DIR`; previous `blit_*` directories cleaned up before re-running the suites. Re-ran Linux suites: small-file (`logs/linux/bench_smallfiles_20251021T012247Z/bench.log`) now blit 4.43 s vs tuned rsync 7.72 s; mixed workload (`logs/linux/bench_mixed_20251021T012509Z/bench.log`) blit 2.59 s vs rsync 5.80 s. Incremental sample reduced to 128 MiB + 10 k files (`logs/linux/bench_incremental_base_20251021T012748Z/.log`, `..._update_20251021T012818Z/.log`) with blit 1.15 s vs rsync 0.68 s on the mutation pass; further tuning needed.
**2025-10-21 02:45:00Z** - **RESULT**: Cross-platform small-file reruns validate the tar-shard heuristics. Linux (`logs/linux/bench_smallfiles_tar_20251021T024313Z/bench.log`) averages 2.90 s (≈194 MiB/s) vs tuned rsync 8.56 s; macOS (`logs/macos/bench_smallfiles_tar_20251021T021418Z/bench.log`) averages 10.53 s vs rsync 11.62 s (~9 % lead). Windows (`logs/wingpt/bench-100k-smallfiles-20251021.log`) now averages 60.63 s vs robocopy 218.48 s (3.6× faster) after the planner fix.
**2025-10-21 03:00:00Z** - **ACTION**: Added planner task instrumentation. `TransferFacade` now tracks tar/raw/large task counts and bytes, exposing them via `LocalPlanFinal` → `LocalMirrorSummary`. Performance history records these stats and the orchestrator seeds small/medium shard thresholds from the most recent runs before planning. Updated PowerShell harness earlier still applies; `cargo test -p blit-core` remains clean.
**2025-10-22 01:55:00Z** - **RESULT**: Phase 2.5 mixed/incremental workloads now clear the GO bar. Linux mixed suite (`logs/linux/bench_mixed_tar_20251022T015203Z/bench.log`) averages 2.24 s vs tuned rsync 6.95 s; incremental baseline (`logs/linux/bench_incremental_base_tar_20251022T015347Z/bench.log`) clocks 0.86 s vs 1.32 s, and the mutation pass (`..._update_20251022T015347Z/bench.log`) averages 0.61 s vs 1.23 s. macOS mirrors these gains (`logs/macos/bench_mixed_tar_20251022T014611Z/bench.log`, `bench_incremental_{base,update}_tar_20251022T0148*.log`). Windows harness confirmation from WingPT captured in `logs/wingpt/bench_mixed_incremental_20251021T230000Z/bench.log` (mixed 31.26 s vs robocopy 110.51 s; incremental baseline 7.10 s vs 20.72 s; mutation 6.45 s vs 6.94 s) with small-file comparator still pending.
**2025-10-22 02:28:00Z** - **ACTION**: CLI verbose summary now reports planner mix (tar shards, bundles, large tasks) using the new instrumentation in `LocalMirrorSummary`, helping debug Phase 2 heuristics when `--verbose` is set. `cargo check -p blit-cli` passes.
**2025-10-23 04:15:10Z** - **ACTION**: CLI remote surface aligned with plan v6. `blit copy|mirror|move` now accept `host:/module/path` endpoints (module sub-paths supported), reusing the existing push/pull transports; redundant push/pull mentions removed from docs. Daemon push handling honours per-transfer destination paths, and `blit list` now interacts with the daemon (`ListModules` / `List`) or falls back to local listings. `cargo clippy` and `cargo test -p blit-core` run clean.
**2025-10-23 22:29:26Z** - **ACTION**: Seeded `blit-utils` with initial admin tooling. `blit-utils list-modules` and `blit-utils ls/list` call the new daemon RPCs (with `--json` support), `blit-utils profile` surfaces local perf history, and other verbs return clear placeholders pending RPC work. Added detailed `docs/plan/BLIT_UTILS_PLAN.md`, expanded Phase 3/4 workflows (predictor tests, schema migrations, hardening).
**2025-10-25 20:01:22Z** - **ACTION**: Added integration coverage for the hybrid transport fallback. New test (`crates/blit-cli/tests/remote_tcp_fallback.rs`) spins up `blit-daemon --force-grpc-data`, runs `blit mirror --force-grpc` against `server:/module/`, and asserts the run completes with gRPC fallback messaging and remote files present. Helper scripts now use `--config-dir` exclusively. **Tests**: `cargo build --bin blit-daemon --target x86_64-unknown-linux-gnu`; `cargo test -p blit-cli --test remote_tcp_fallback --target x86_64-unknown-linux-gnu`.

**2025-10-25 22:54:02Z** - **RESULT**: Verified remote fallback on skippy/mycroft. Normal runs negotiated the TCP data plane; forcing `--force-grpc` logged `[gRPC fallback]` and mirrored successfully (`logs/remote/skippy.internal_force_20251025T225340Z.log`, `logs/remote/mycroft.internal_force_20251025T225340Z.log`).
**2025-10-26 00:09:53Z** - **RESULT**: Captured refreshed large-file benchmarks across all platforms to close out Phase 2.5 evidence. Linux 1 GiB run (`logs/linux/bench_local_linux_20251025T230101Z.log`) shows blit 1.427 s vs rsync 3.206 s (~225 %). macOS 1 GiB/4 GiB runs (`logs/macos/bench_local_20251025T231137Z/bench.log`, `logs/macos/bench_local_20251025T235415Z/bench.log`) landed at 0.712 s vs 2.427 s and 2.823 s vs 9.721 s respectively. Windows NTFS 1 GiB (`logs/windows/bench_local_windows_20251025T233442Z.log`) is within ~7 % of robocopy (1.619 s vs 1.516 s), while the ReFS 4 GiB case (`logs/windows/bench_local_windows_4gb_20251025T235715Z.log`) still trails (0.374 s vs 0.155 s, ~41 %). Added a TrueNAS/ZFS datapoint (`logs/truenas/bench_local_zfs_20251026T004021Z.log`): blit averaged 0.879 s vs rsync 18.309 s on the same 4 GiB workload. TODO updated to track the remaining ReFS delta; plan/workflow docs reference the new numbers. **Tests/Commands**: `SOURCE_DIR=/tmp/blit_linux_bench/src DEST_DIR=/tmp/blit_linux_bench/dest SIZE_MB=1024 RUNS=5 WARMUP=1 KEEP_BENCH_DIR=1 scripts/bench_local_mirror.sh`; `SIZE_MB=1024 RUNS=5 WARMUP=1 KEEP_BENCH_DIR=1 ./scripts/bench_local_mirror_macos.sh`; `SIZE_MB=4096 RUNS=5 WARMUP=1 KEEP_BENCH_DIR=1 ./scripts/bench_local_mirror_macos.sh` (macGPT); `pwsh scripts/windows/bench-local-mirror.ps1 -SizeMB 1024 -Runs 5 -Warmup 1`; `pwsh scripts/windows/bench-local-mirror.ps1 -SizeMB 4096 -Runs 5 -Warmup 1` (WingPT); `BLIT_BIN=./target/release/blit-cli BENCH_ROOT=/mnt/specific-pool/home/stuff/backup/temp SOURCE_DIR=/mnt/specific-pool/home/stuff/backup/temp/src DEST_DIR=/mnt/specific-pool/home/stuff/backup/temp/dest SIZE_MB=4096 RUNS=5 WARMUP=1 KEEP_BENCH_DIR=1 scripts/bench_local_mirror.sh` (TrueNAS).
**2025-10-26 02:06:31Z** - **RESULT**: Re-ran 4 GiB ReFS mirror with the new block-clone path on a ReFS-backed temp root (`TEMP/TMP=D:\blit_bench`). `logs/windows/bench_local_windows_4gb_clone_20251026T020337Z.log` shows blit averaging 0.590 s (best 0.385 s) vs robocopy 0.165 s (best 0.149 s)—clone is active but robocopy still leads by ~3×. Planner integration confirmed via per-file raw tasks. TODO/workflow updated; future harness work needed to avoid silently running on NTFS when env isn’t set. **Commands**: `pwsh scripts/windows/bench-local-mirror.ps1 -SizeMB 4096 -Runs 5 -Warmup 1` with `TEMP/TMP` pointed at ReFS.
